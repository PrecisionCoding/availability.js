(function(e,t){"use strict";var r=6e4;var a=r*60;var i=a*24;var n=i*30;var s=t.__availability_base_url||"https://my.cushionapp.com";var l="available";var u="unavailable";var o="soon";var c="private";var h=function(){this.user={};this.date=null;this.hours=0;this.availability=u};h.prototype.isAvailable=function(){return l===this.availability};h.prototype.isUnavailable=function(){return u===this.availability};h.prototype.isSoon=function(){return o===this.availability};h.prototype.isPrivate=function(){return c===this.availability};h.prototype.monthShort=function(){if(!this.date)return;switch(this.date.getMonth()){case 0:return"Jan";case 1:return"Feb";case 2:return"March";case 3:return"April";case 4:return"May";case 5:return"June";case 6:return"July";case 7:return"Aug";case 8:return"Sept";case 9:return"Oct";case 10:return"Nov";case 11:return"Dec"}};h.prototype.month=function(){if(!this.date)return;switch(this.date.getMonth()){case 0:return"January";case 1:return"February";case 2:return"March";case 3:return"April";case 4:return"May";case 5:return"June";case 6:return"July";case 7:return"August";case 8:return"September";case 9:return"October";case 10:return"November";case 11:return"December"}};h.prototype.referralUrl=function(){if(this.user&&this.user.referral_code){return"http://get.cushionapp.com/"+this.user.referral_code}};function v(e){if(!e.user)return console.error("Must specify a user");if(!e.renderer)return console.error("Must specify a renderer");var t=new h;var r=new XMLHttpRequest;r.addEventListener("load",p(t,e.renderer));r.open("GET",s+"/api/v1/users/"+e.user+"/availability");r.send();return t}function p(e,t){return function(){switch(this.status){default:return console.error("Cushion API Error",this.status);case 404:return console.error("That user ID wasnt found");case 401:console.error("Enable the Availability Badge: "+s+"/add-ons/availability-badge");e.availability=c;break;case 200:var r=JSON.parse(this.response);if(r.user)e.user=r.user;if(r.availability){e.date=b(r.availability.available_on);e.hours=r.availability.hours_per_week;e.availability=d(e.date)}break}return t.call(e)}}function b(e){e=e.split("-");var t=parseInt(e[0]);var r=parseInt(e[1])-1;var a=parseInt(e[2]);return new Date(t,r,a)}function d(e){var t=e-Date.now();if(e&&t<n)return l;if(e&&t<10*n)return o;return u}function f(e,t){var r=Array.prototype.slice.call(arguments,2);var a=document.createElementNS(e.namespaceURI,t);e.appendChild(a);if(r.length>0){r.unshift(a);y.apply(this,r)}return a}function y(e){var t=Array.apply(null,arguments).slice(1);for(var r=t.length-1;r>=0;r--){if(t[r].length===3){e.setAttributeNS.apply(e,t[r])}else{e.setAttribute.apply(e,t[r])}}return e}function w(e){var t=e.container||document.body;var r=e.href;function a(){switch(this.availability){case l:return"Available";case o:return"Available in "+this.monthShort();case u:return"Not Available";case c:return"Error"}}e.renderer=function(){if(r===undefined)r=this.referralUrl();var e=document.createElementNS("http://www.w3.org/2000/svg","svg");y(e,["width","150px"],["height","160px"],["style","position: absolute; top: 0; right: 0;"],["class","availability-ribbon "+this.availability]);var i=f(e,"defs");f(i,"path",["d","M17,0 L150,133 Z"],["id","availability_path"]);f(i,"path",["d","M0,17 L183,200 Z"],["id","power_path"]);f(e,"path",["d","M0,0 L50,0 L150,100 L150,150 L0,0 Z"],["class","availability-ribbon__banner"]);var n=f(e,"text",["font-size",16],["text-anchor","middle"],["class","availability-ribbon__text"],["x",96]);var s=f(n,"textPath",["http://www.w3.org/1999/xlink","xlink:href","#availability_path"]);s.textContent=a.call(this);var l=f(e,"text",["font-size",12],["text-anchor","right"],["class","availability-ribbon__power"],["x",90]);var u=f(l,"textPath",["http://www.w3.org/1999/xlink","xlink:href","#power_path"]);u.textContent="powered by Cushion";if(r){var o=f(t,"a",["href",r],["target","_blank"]);o.appendChild(e)}else{t.appendChild(e)}};return v(e)}function g(e){var t=e.container;var r=e.href;function a(){switch(this.availability){case l:return"available";case o:return"booked until "+this.month();case u:return"unavailable";case c:return"error"}}e.renderer=function(){if(r===undefined)r=this.referralUrl();var e=f(t,r?"a":"span",["class","availability-badge "+this.availability]);if(r){e.href=r;e.target="_blank"}e.textContent=a.call(this)};return v(e)}e.display=v;e.badge=g;e.ribbon=w;if(typeof window!=="undefined"){window.addEventListener("load",function _(){window.removeEventListener("load",_,false);var e=document.querySelector("script[data-user]");if(!e)return;var t=e.getAttribute("data-user");var r=document.querySelector("[data-availability-badge]");if(r){g({user:t,container:r})}else{w({user:t})}})}t["Availability"]=e})({},function(){return this}());