(function(e,t){"use strict";var r=2628e6;var a=t.__availability_base_url||"https://my.cushionapp.com";var i="available";var n="unavailable";var s="soon";var u="private";var l=function(){this.user={};this.date=null;this.hours=0;this.availability=n};l.prototype.isAvailable=function(){return i===this.availability};l.prototype.isUnavailable=function(){return n===this.availability};l.prototype.isSoon=function(){return s===this.availability};l.prototype.isPrivate=function(){return u===this.availability};l.prototype.monthShort=function(){if(!this.date)return;switch(this.date.getMonth()){case 0:return"Jan";case 1:return"Feb";case 2:return"March";case 3:return"April";case 4:return"May";case 5:return"June";case 6:return"July";case 7:return"Aug";case 8:return"Sept";case 9:return"Oct";case 10:return"Nov";case 11:return"Dec"}};l.prototype.month=function(){if(!this.date)return;switch(this.date.getMonth()){case 0:return"January";case 1:return"February";case 2:return"March";case 3:return"April";case 4:return"May";case 5:return"June";case 6:return"July";case 7:return"August";case 8:return"September";case 9:return"October";case 10:return"November";case 11:return"December"}};l.prototype.referralUrl=function(){if(this.user&&this.user.referral_code){return"http://get.cushionapp.com/"+this.user.referral_code}};function o(e){if(!e.user)return console.error("Must specify a user");if(!e.render)return console.error("Must specify a render function");var t=new l;var r=new XMLHttpRequest;r.addEventListener("load",c(t,e.render));r.open("GET",a+"/api/v1/users/"+e.user+"/availability");r.send();return t}function c(e,t){return function(){switch(this.status){default:return console.error("Cushion API Error",this.status);case 404:return console.error("That user ID wasnt found");case 401:console.error("Enable the Availability Badge: "+a+"/add-ons/availability-badge");e.availability=u;break;case 200:var r=JSON.parse(this.response);if(r.user)e.user=r.user;if(r.availability){e.date=h(r.availability.available_on);e.hours=r.availability.hours_per_week;e.availability=v(e.date)}break}return t.call(e)}}function h(e){e=e.split("-");var t=parseInt(e[0]);var r=parseInt(e[1])-1;var a=parseInt(e[2]);return new Date(t,r,a)}function v(e){var t=e-Date.now();if(e&&t<r)return i;if(e&&t<10*r)return s;return n}function p(e,t){var r=Array.prototype.slice.call(arguments,2);var a=document.createElementNS(e.namespaceURI,t);e.appendChild(a);if(r.length>0){r.unshift(a);b.apply(this,r)}return a}function b(e){var t=Array.apply(null,arguments).slice(1);for(var r=t.length-1;r>=0;r--){if(t[r].length===3){e.setAttributeNS.apply(e,t[r])}else{e.setAttribute.apply(e,t[r])}}return e}function f(e){var t=e.container||document.body;var r=e.href;function a(){switch(this.availability){case i:return"Available";case s:return"Available in "+this.monthShort();case n:return"Not Available";case u:return"Error"}}e.render=function(){if(r===undefined)r=this.referralUrl();var e=document.createElementNS("http://www.w3.org/2000/svg","svg");b(e,["width","150px"],["height","160px"],["style","position: absolute; top: 0; right: 0;"],["class","availability-ribbon "+this.availability]);var i=p(e,"defs");p(i,"path",["d","M17,0 L150,133 Z"],["id","availability_path"]);p(i,"path",["d","M0,17 L183,200 Z"],["id","power_path"]);p(e,"path",["d","M0,0 L50,0 L150,100 L150,150 L0,0 Z"],["class","availability-ribbon__banner"]);var n=p(e,"text",["font-size",16],["text-anchor","middle"],["class","availability-ribbon__text"],["x",96]);var s=p(n,"textPath",["http://www.w3.org/1999/xlink","xlink:href","#availability_path"]);s.textContent=a.call(this);var u=p(e,"text",["font-size",12],["text-anchor","right"],["class","availability-ribbon__power"],["x",90]);var l=p(u,"textPath",["http://www.w3.org/1999/xlink","xlink:href","#power_path"]);l.textContent="powered by Cushion";if(r){var o=p(t,"a",["href",r],["target","_blank"]);o.appendChild(e)}else{t.appendChild(e)}};return o(e)}function d(e){var t=e.container;var r=e.href;function a(){switch(this.availability){case i:return"available";case s:return"booked until "+this.month();case n:return"unavailable";case u:return"error"}}e.render=function(){if(r===undefined)r=this.referralUrl();var e=p(t,r?"a":"span",["class","availability-badge "+this.availability]);if(r){e.href=r;e.target="_blank"}e.textContent=a.call(this)};return o(e)}e.custom=o;e.badge=d;e.ribbon=f;if(typeof window!=="undefined"&&t===window){document.addEventListener("DOMContentLoaded",function(){var e=document.querySelector("script[data-user]");if(!e)return;var t=e.getAttribute("data-user");var r=document.querySelector("[data-availability-badge]");if(r){d({user:t,container:r})}else{f({user:t})}})}t["Availability"]=e})({},function(){return this}());